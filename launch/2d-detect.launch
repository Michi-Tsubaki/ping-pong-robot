<launch>
  <group ns="ball_detection">
    <arg name="node_name1" default="hsv_color_filter" />
    <arg name="image1" default="/camera/color/image_raw" doc="The image topic. Should be remapped to the name of the real image topic." />
    <arg name="use_camera_info1" default="false" doc="Indicates that the camera_info topic should be subscribed to to get the default input_frame_id. Otherwise the frame from the image message will be used." />
    <arg name="debug_view1" default="false" doc="Specify whether the node displays a window to show image" />
    <arg name="queue_size1" default="3" doc="Specigy queue_size of input image subscribers" />
    <arg name="h_limit_max" default="8" doc="The maximum allowed field value Hue" />
    <arg name="h_limit_min" default="352" doc="The minimum allowed field value Hue" />
    <arg name="s_limit_max" default="255" doc="The maximum allowed field value Saturation" />
    <arg name="s_limit_min" default="170" doc="The minimum allowed field value Saturation" />
    <arg name="v_limit_max" default="255" doc="The maximum allowed field value Value" />
    <arg name="v_limit_min" default="1" doc="The minimum allowed field value Value" />

    <arg name="node_name2" default="edge_detection" />
    <arg name="image2" default="/ball_detection/hsv_color_filter/image" doc="The image topic. Should be remapped to the name of the real image topic." />
    <arg name="use_camera_info2" default="false" doc="Indicates that the camera_info topic should be subscribed to to get the default input_frame_id. Otherwise the frame from the image message will be used." />
    <arg name="debug_view2" default="false" doc="Specify whether the node displays a window to show edge image" />
    <arg name="queue_size2" default="3" doc="Specigy queue_size of input image subscribers" />
    <arg name="edge_type" default="0" doc="Specify edge dtection methods. 0: Sobel Derivatives, 1: Lapalace Operator, 2, Canny Edge Detector." />
    <arg name="canny_threshold1" default="100" doc="Specify second canny threashold value." />
    <arg name="canny_threshold2" default="200" doc="Specity first canny threashold value." />
    <arg name="apertureSize" default="3" doc="Aperture size for the Sobel() operator." />
    <arg name="apply_blur_pre" default="true" doc="Flag, applying Blur() to input image" />
    <arg name="postBlurSize" default="13" doc="Aperture size for the Blur() to input image()" />
    <arg name="postBlurSigma" default="3.2" doc="Sigma for the GaussianBlur() to input image." />
    <arg name="apply_blur_post" default="false" doc="Flag, applying GaussinaBlur() to output(edge) image" />
    <arg name="L2gradient" default="false" doc="Flag, L2Gradient" />

  <arg name="node_name3" default="hough_circles" />

  <arg name="image3" default="/ball_detection/edge_detection/image" doc="The image topic. Should be remapped to the name of the real image topic." />

  <arg name="use_camera_info3" default="false" doc="Indicates that the camera_info topic should be subscribed to to get the default input_frame_id. Otherwise the frame from the image message will be used." />
  <arg name="debug_view3" default="false" doc="Specify whether the node displays a window to show edge image" />
  <arg name="queue_size3" default="3" doc="Specigy queue_size of input image subscribers" />

  <arg name="canny_threshold" default="300" doc="Upper threshold for the internal Canny edge detector." />
  <arg name="accumulator_threshold" default="80" doc="Threshold for center detection." />
  <arg name="gaussian_blur_size" default="20" doc="The size of gaussian blur (should be odd number)" />
  <arg name="gaussian_sigma_x" default="2" doc="Sigma x of gaussian kernel" />
  <arg name="gaussian_sigma_y" default="2" doc="Sigma y of gaussian kernel" />
  <arg name="dp" default="2" doc="The inverse ratio of resolution." />
  <arg name="min_circle_radius" default="1" doc="The minimum size of the circle, If unknown, put zero as default" />
  <arg name="max_circle_radius" default="400" doc="The maximum size of the circle, If unknown, put zero as default." />


    <!-- color_filter.cpp  -->
    <node name="$(arg node_name1)" pkg="opencv_apps" type="hsv_color_filter" output="screen">
      <remap from="image" to="$(arg image1)" />
      <param name="use_camera_info" value="$(arg use_camera_info1)" />
      <param name="debug_view" value="$(arg debug_view1)" />
      <param name="queue_size" value="$(arg queue_size1)" />
      <param name="h_limit_max" value="$(arg h_limit_max)" />
      <param name="h_limit_min" value="$(arg h_limit_min)" />
      <param name="s_limit_max" value="$(arg s_limit_max)" />
      <param name="s_limit_min" value="$(arg s_limit_min)" />
      <param name="v_limit_max" value="$(arg v_limit_max)" />
      <param name="v_limit_min" value="$(arg v_limit_min)" />
    </node>

    <!-- edge_detection.cpp  -->
    <node name="$(arg node_name2)" pkg="opencv_apps" type="edge_detection" >
      <remap from="image" to="$(arg image2)" />
      <param name="use_camera_info" value="$(arg use_camera_info2)" />
      <param name="debug_view" value="$(arg debug_view2)" />
      <param name="queue_size" value="$(arg queue_size2)" />
      <param name="edge_type" value="$(arg edge_type)" />
      <param name="canny_threshold1" value="$(arg canny_threshold1)" />
      <param name="canny_threshold2" value="$(arg canny_threshold2)" />
      <param name="apertureSize" value="$(arg apertureSize)" />
      <param name="apply_blur_pre" value="$(arg apply_blur_pre)" />
      <param name="postBlurSize" value="$(arg postBlurSize)" />
      <param name="postBlurSigma" value="$(arg postBlurSigma)" />
      <param name="apply_blur_post" value="$(arg apply_blur_post)" />
      <param name="L2gradient" value="$(arg L2gradient)" />
    </node>

    <node name="$(arg node_name3)" pkg="opencv_apps" type="hough_circles">
      <remap from="image" to="$(arg image3)" />
      <param name="use_camera_info" value="$(arg use_camera_info3)" />
      <param name="debug_view" value="$(arg debug_view3)" />
      <param name="queue_size" value="$(arg queue_size3)" />
      <param name="canny_threshold" value="$(arg canny_threshold)" />
      <param name="accumulator_threshold" value="$(arg accumulator_threshold)" />
      <param name="gaussian_blur_size" value="$(arg gaussian_blur_size)" />
      <param name="gaussian_sigma_x" value="$(arg gaussian_sigma_x)" />
      <param name="gaussian_sigma_y" value="$(arg gaussian_sigma_y)" />
      <param name="dp" value="$(arg dp)" />
      <param name="min_circle_radius" value="$(arg min_circle_radius)" />
      <param name="max_circle_radius" value="$(arg max_circle_radius)" />
    </node>
  </group>
</launch>
